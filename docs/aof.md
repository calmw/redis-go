#### 数据持久化，将数据写入磁盘

- Redis 也是如此。根据你的需求，有不同的方法来持久化数据：
    - RDB（Redis 数据库）：这是根据配置定期创建的数据快照。例如，每 3 分钟或每 10 分钟一次，具体取决于您的配置方式。在此方法中，Redis
      会将内存中的数据完整复制并保存到文件中。当发生重新启动或崩溃时，将从 RDB 文件重新加载数据。
    - AOF（Append only file）：在这种方式下，Redis 将每条命令以 RESP 的形式记录在文件中，当发生重启时，Redis 会从 AOF 文件中读取所有
      RESP 命令并在内存中执行
- 我们将使用的方法很简单，因为我们可以将其链接到我们创建的 RESP 结构。每次执行命令时，我们都会在文件中记录其 RESP
  表示。当服务器/代码启动时，它将从 AOF 文件中读取并将这些命令发送给读取器，读取器将在内存中执行它们

#### 在开始之前我先解释一下AOF文件的格式：

```shell
#如果我们执行了2个命令:

> set name ahmed
> set website ahmedash95.github.io
#该文件的内容如下：
*2
$3
set
$4
name
*3
$3
set
$4
name
$5
ahmed
*3
$3
set
$7
website
$20
ahmedash95.github.io

```

#### 同步到磁盘

- 每秒同步一次的想法可确保我们所做的更改始终存在于磁盘上。如果没有同步，则由操作系统决定何时将文件刷新到磁盘。
- 通过这种方法，我们可以确保即使在发生崩溃的情况下数据也始终可用。如果我们丢失任何数据，那也只会在崩溃后的一秒钟内发生，这是一个可以接受的速率。
- 如果想要 100% 的持久性，我们就不需要 goroutine。相反，我们会在每次执行命令时同步文件。但是，这会导致写入操作性能不佳，因为
  IO 操作很昂贵。
